# 手机传感器数据采集与可视化系统

这个项目实现了一个基于MQTT协议的手机传感器数据采集与可视化系统，包含Android客户端和Rust编写的桌面端应用。系统可以实时采集手机加速度传感器数据，并通过MQTT协议传输到电脑端进行实时显示和分析。

## 系统架构

整个系统包含三个主要部分：

1. **Android客户端**：收集手机加速度传感器数据并通过MQTT协议发送
2. **MQTT服务器**：中转数据的消息代理服务器
3. **桌面端应用**：接收传感器数据并进行图形化显示

## 功能特点

- 实时采集手机加速度传感器数据和语音数据（X, Y, Z三轴数据）
- 通过MQTT协议进行高效稳定的数据传输
- 数据实时可视化显示，支持5秒滚动时间窗口
- 支持多设备同时连接（通过不同的客户端ID）
- 轻量级设计，低延迟数据传输

## 技术栈

- **Android客户端**：Kotlin + MQTT Paho客户端
- **桌面应用**：Rust + eframe/egui (GUI) + rumqttc (MQTT客户端)
- **通信协议**：MQTT
- **数据存储：**DuckDB

## 使用方法

### 桌面端应用

1. 确保已安装Rust编程环境
2. 配置 `.env`文件，设置MQTT服务器连接参数：
   ```
   MQTT_HOST=你的MQTT服务器地址
   MQTT_PORT=1883
   MQTT_USER=你的用户名
   MQTT_PASS=你的密码
   ```
3. 编译并运行应用：
   ```bash
   cargo run --release
   ```

### Android客户端

1. 在Android Studio中打开 `androidclient`目录
2. 根据需要修改 `MainActivity.kt`中的MQTT服务器设置：
   ```kotlin
   private val mqttServerUri = "tcp://你的服务器IP:1883"
   private val mqttUsername = "你的用户名"
   private val mqttPassword = "你的密码"
   ```
3. 构建并安装应用到手机

### MQTT服务器设置

可以使用任意支持MQTT协议的消息代理服务器，如：

- Mosquitto
- EMQ X
- HiveMQ

设置好服务器后，确保在Android客户端和桌面应用中使用相同的连接参数。

## 数据格式

系统使用JSON格式传输传感器数据，示例：

```json
{
  "x": 0.123456,
  "y": -0.234567,
  "z": 9.876543,
  "timestamp": 1647432123456
}
```

## 开发与扩展

系统设计为模块化结构，可以方便地扩展以支持更多传感器类型或添加新功能：

### TODO 列表

- [X] 实现数据保存和导出功能（支持CSV格式）
- [ ] 扩展Android客户端支持更多传感器（陀螺仪、磁力计等）
- [X] 添加可配置的采样率设置
- [ ] 实现数据过滤和预处理算法
- [ ] 添加多设备数据对比显示功能
- [ ] 实现数据回放功能
- [ ] 添加多传感器时间戳自动对齐

## 问题排查

- 确保Android设备和电脑在同一网络环境中
- 检查MQTT服务器是否正常运行及防火墙设置
- 查看应用日志以获取错误详情

## 许可证

本项目采用MIT许可证

## 贡献

欢迎贡献代码或提出建议，请提交问题报告或合并请求。
